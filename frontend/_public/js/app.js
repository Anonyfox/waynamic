"use strict";var App;App=angular.module("app",["ngCookies","ngResource","ngRoute","app.controllers","app.directives","app.filters","app.services","partials"]),App.config(["$routeProvider","$locationProvider",function(n,e){return n.when("/",{templateUrl:"/partials/landingpage.html"}).when("/pictures",{templateUrl:"/partials/pictures.html"}).otherwise({redirectTo:"/"}),e.html5Mode(!1)}]),angular.module("app.controllers",[]).controller("AppCtrl",["$scope","$location","$resource","$rootScope",function(n,e){return n.$location=e,n.$watch("$location.path()",function(e){return n.activeNavId=e||"/"}),n.getClass=function(e){return n.activeNavId.substring(0,e.length)===e?"active":""}}]).controller("PicturesCtrl",["$scope","Pictures",function(n,e){return n.currentPictures=[],e.getInitialPics(function(e,t){return e?console.log(e):n.currentPictures=t.data}),n.requestPictures=function(t){return e.getForKeywords(t,function(e,t){return e?alert(e):(console.log(t.data),n.currentPictures=t.data)})},n.nextPicturesByUrl=function(e){var t;return t=_.filter(n.currentPictures,function(n){return n.url===e})[0],n.requestPictures((null!=t?t.tags:void 0)||[])},n.nextPicturesByTag=function(e){return n.requestPictures([e])}}]).controller("LoginCtrl",["$scope","User",function(n,e){return n.loginNewUser=function(){var t;return t=n.newUser.nodeId,e.login(function(n,e){return n?console.log("LoginError! ",n):console.log("Logged IN! ",e)})}}]),angular.module("app.directives",["app.services"]).directive("appVersion",["version",function(n){return function(e,t){return t.text(n)}}]),angular.module("app.filters",[]).filter("interpolate",["version",function(n){return function(e){return String(e).replace(/\%VERSION\%/gm,n)}}]),angular.module("app.services",[]).service("User",["$http",function(n){var e;return e={name:null,loggedIn:!1},{currentUser:function(){return e},login:function(e,t){return n.post("/login",{id:e}).then(function(n){return"function"==typeof t?t(null,n):void 0},function(n){return"function"==typeof t?t({error:n.error||"Node ID invalid!"},null):void 0})},logout:function(){return n.post("/logout").then(function(){return e={name:null,loggedIn:!1}},function(){return e={name:null,loggedIn:!1}})},checkSession:function(){return n.get("/loggedin").then(function(n){return e.name=n.data.name,e.loggedIn=!0},function(){})}}}]).service("Pictures",["$http",function(n){return{getForKeywords:function(e,t){return n.get("/pictures?keywords="+e.join(",")).then(function(n){return"function"==typeof t?t(null,n):void 0},function(){return"function"==typeof t?t({error:"Something went wrong. Flickr unavailable?"},null):void 0})},getInitialPics:function(e){return n.get("/picturesInit").then(function(n){return"function"==typeof e?e(null,n):void 0},function(){return"function"==typeof e?e({error:"Something went wrong. Flickr unavailable?"},null):void 0})}}}]);