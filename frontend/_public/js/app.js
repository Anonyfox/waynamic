"use strict";var App;App=angular.module("app",["ngCookies","ngResource","ngRoute","app.controllers","app.directives","app.filters","app.services","partials"]),App.config(["$routeProvider","$locationProvider",function(e,r){return e.when("/",{templateUrl:"/partials/landingpage.html"}).when("/pictures",{templateUrl:"/partials/pictures.html"}).when("/profile",{templateUrl:"/partials/profile.html"}).otherwise({redirectTo:"/"}),r.html5Mode(!1)}]),angular.module("app.controllers",[]).controller("AppCtrl",["$scope","$location","$resource","$rootScope",function(e,r){return e.$location=r,e.$watch("$location.path()",function(r){return e.activeNavId=r||"/"}),e.getClass=function(r){return e.activeNavId.substring(0,r.length)===r?"active":""}}]).controller("NavCtrl",["$scope","User",function(e,r){return e.changeSelectedUser=function(e){return r.setCurrentUser(e)},r.getAllUsers()}]).controller("ProfileCtrl",["$scope","User",function(e,r){return r.getUserProfile(),e.$watch("users.current._id",function(e,t){return e!==t?r.getUserProfile():void 0})}]).controller("PicturesCtrl",["$scope","$rootScope","Pictures","User",function(e,r,t){return r.Current.list.length||t.getInitialPics(),e.$watch("users.current._id",function(e,r){return e!==r?t.getInitialPics():void 0}),e.feedback=function(e){var n;return $("#pictures-view").hide(),n=_.extend(r.Current,{clicked:e}),t.getPicsByFeedback(n,function(){return $("#pictures-view").fadeIn()})}}]),angular.module("app.directives",["app.services"]).directive("appVersion",["version",function(e){return function(r,t){return t.text(e)}}]),angular.module("app.filters",[]).filter("interpolate",["version",function(e){return function(r){return String(r).replace(/\%VERSION\%/gm,e)}}]),angular.module("app.services",[]).service("User",["$http","$rootScope",function(e,r){return r.users={list:[],current:{_id:-1,name:""}},{currentUserId:function(){return r.users.current._id},setCurrentUser:function(e){return r.users.current=_.pick(e,"_id","name")},setCurrentUserById:function(e){return r.users.current=_.find(r.users.list,function(r){return r._id===e})},getAllUsers:function(t){return e.get("/users").then(function(e){return r.users.list=_.map(e.data,function(e){return{_id:e._id,name:"#"+e._id+" "+e.firstName+" "+e.lastName}}),"function"==typeof t?t(null,r.users.list):void 0},function(){return"function"==typeof t?t(null,[]):void 0})},getUserProfile:function(t){return e.get("/users/"+r.users.current._id+"/profile").then(function(e){return r.users.currentFriends=e.data.friends,r.users.currentHistory=e.data.history,"function"==typeof t?t(null,r.current):void 0},function(){return"function"==typeof t?t(null,{}):void 0})}}}]).service("Pictures",["$http","$rootScope","User",function(e,r,t){return r.Current={list:[],current:{_id:0,url:""}},{getPicsByFeedback:function(n,i){return e.post("/users/"+t.currentUserId()+"/pictures",n).then(function(e){return r.Current=e.data,"function"==typeof i?i(null,e.data):void 0},function(){return"function"==typeof i?i({error:"Something went wrong. Flickr unavailable?"},null):void 0})},getInitialPics:function(n){return e.get("/users/"+t.currentUserId()+"/pictures").then(function(e){return r.Current=e.data,"function"==typeof n?n(null,e.data):void 0},function(){return"function"==typeof n?n({error:"Something went wrong. Flickr unavailable?"},null):void 0})}}}]);