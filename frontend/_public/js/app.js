"use strict";var App;App=angular.module("app",["ngCookies","ngResource","ngRoute","app.controllers","app.directives","app.filters","app.services","partials"]),App.config(["$routeProvider","$locationProvider",function(r,e){return r.when("/",{templateUrl:"/partials/landingpage.html"}).when("/pictures",{templateUrl:"/partials/pictures.html"}).when("/profile",{templateUrl:"/partials/profile.html"}).otherwise({redirectTo:"/"}),e.html5Mode(!1)}]),angular.module("app.controllers",[]).controller("AppCtrl",["$scope","$location","$resource","$rootScope",function(r,e){return r.$location=e,r.$watch("$location.path()",function(e){return r.activeNavId=e||"/"}),r.getClass=function(e){return r.activeNavId.substring(0,e.length)===e?"active":""}}]).controller("NavCtrl",["$scope","User",function(r,e){return r.changeSelectedUser=function(r){return e.setCurrentUser(r)},e.getAllUsers()}]).controller("ProfileCtrl",["$scope","User",function(r,e){return e.getUserProfile(),r.$watch("users.current._id",function(r,t){return r!==t?e.getUserProfile():void 0}),r.switchUserTo=function(r){return e.setCurrentUserById(r)}}]).controller("PicturesCtrl",["$scope","$rootScope","Pictures","User",function(r,e,t){return e.Current.list.length||t.getInitialPics(),r.$watch("users.current._id",function(r,e){return r!==e?t.getInitialPics():void 0}),r.feedback=function(r){var n;return $("#pictures-view").hide(),n=_.extend(e.Current,{clicked:r}),t.getPicsByFeedback(n,function(){return $("#pictures-view").fadeIn()})}}]),angular.module("app.directives",["app.services"]).directive("appVersion",["version",function(r){return function(e,t){return t.text(r)}}]),angular.module("app.filters",[]).filter("interpolate",["version",function(r){return function(e){return String(e).replace(/\%VERSION\%/gm,r)}}]),angular.module("app.services",[]).service("User",["$http","$rootScope",function(r,e){return e.users={list:[],current:{_id:-1,name:""}},{currentUserId:function(){return e.users.current._id},setCurrentUser:function(r){return e.users.current=r},setCurrentUserById:function(r){return e.users.current=_.find(e.users.list,function(e){return e._id===r})},getAllUsers:function(t){return r.get("/users").then(function(r){return e.users.list=_.map(r.data,function(r){return{_id:r._id,name:"#"+r._id+" "+r.firstName+" "+r.lastName}}),"function"==typeof t?t(null,e.users.list):void 0},function(){return"function"==typeof t?t(null,[]):void 0})},getUserProfile:function(t){return r.get("/users/"+e.users.current._id+"/profile").then(function(r){return e.users.current.friends=r.data.friends,e.users.current.history=r.data.history,"function"==typeof t?t(null,e.current):void 0},function(){return"function"==typeof t?t(null,{}):void 0})}}}]).service("Pictures",["$http","$rootScope","User",function(r,e,t){return e.Current={list:[],current:{_id:0,url:""}},{getPicsByFeedback:function(n,u){return r.post("/users/"+t.currentUserId()+"/pictures",n).then(function(r){return e.Current=r.data,"function"==typeof u?u(null,r.data):void 0},function(){return"function"==typeof u?u({error:"Something went wrong. Flickr unavailable?"},null):void 0})},getInitialPics:function(n){return r.get("/users/"+t.currentUserId()+"/pictures").then(function(r){return e.Current=r.data,"function"==typeof n?n(null,r.data):void 0},function(){return"function"==typeof n?n({error:"Something went wrong. Flickr unavailable?"},null):void 0})}}}]);